Avionics Full-Duplex Switched Ethernet (AFDX) — это сеть передачи данных, запатентованная международным производителем самолетов Airbus для критически важных по безопасности приложений, использующая выделенную полосу пропускания при обеспечении заданного качества обслуживания (QoS). AFDX является зарегистрированным во всём мире товарным знаком Airbus. Сеть передачи данных AFDX основана на технологии Ethernet с использованием коммерческих готовых компонентов (COTS). Сеть передачи данных AFDX является специфической реализацией спецификации ARINC 664 часть 7, профилированной версии сети IEEE 802.3 в части 1 и 2, которая определяет, как готовые сетевые компоненты должны использоваться в сетях данных воздушных судов будущего поколения (ADN). Шесть основных аспектов сети передачи данных AFDX включают полный дуплекс, избыточность, детерминизм, быстродействие, коммутируемую и профилированную сеть.

История
Многие коммерческие самолёты используют стандарт ARINC 429, разработанный в 1977 году для критически важных приложений. ARINC 429 использует однонаправленную шину с одним передатчиком и до двадцати приемников. Слово данных состоит из 32 битов, передаваемых по витой паре с использованием биполярной модуляции с возвратом к нулю. Предусмотрено две скорости передачи: высокая скорость 100 кбит/с, и низкая — 12,5 кбит/с. ARINC 429 устроена так, что его единственный передатчик обменивается данными в двухточечном соединении, что требует значительного количества проводки и увеличивает её вес.
Следующий стандарт, ARINC 629, был введён Boeing для модели 777. Он обеспечил увеличение скорости передачи данных до 2 Мбит/с и позволил использовать до 120 терминалов данных. Эта авиационная шина данных работает без использования контроллера шины, что повышает надёжность сетевой архитектуры. Недостатком является потребность в специальном оборудовании, способном заметно увеличить стоимость самолёта. Из-за этого стандарт ARINC 629 не был принят другими производителями.
AFDX был разработан как сеть передачи данных для самолётов следующего поколения. Основанное на стандартах комитета IEEE 802.3 (обычно называемых Ethernet), готовое коммерческое оборудование сокращает затраты и время разработки. AFDX — это одна из реализаций детерминированного Ethernet, определённая в спецификации ARINC 664, часть 7. AFDX был разработан Airbus Industries для A380 первоначально для решения проблем в реальном времени при разработке системы управления полетом. Основываясь на опыте работы с A380, Airbus A350 также использует сеть AFDX с авионикой и системами, поставляемыми Rockwell Collins. Airbus и её материнская компания EADS предоставили лицензии AFDX в рамках инициативы EADS Technology Licensing, включая соглашения с Selex ES и Vector Informatik GmbH. Схожая реализация детерминированного Ethernet используется на Boeing 787 Dreamliner. Несколько коммутаторов могут быть соединены вместе в каскадной звездообразной топологии. Такой тип сети может значительно уменьшить количество проводов и, следовательно, общий вес самолёта. Кроме того, AFDX может обеспечить качество обслуживания и двухканальное резервирование.

Обзор AFDX
AFDX заимствовал такие концепции, как алгоритм дырявого ведра из телекоммуникационных стандартов, асинхронный режим передачи (ATM), чтобы исправить недостатки IEEE 802.3 Ethernet. Путем добавления ключевых элементов из ATM к уже имеющимся в Ethernet и ограничения спецификации различных опций создается высоконадежная полнодуплексная детерминированная сеть, обеспечивающая гарантированную полосу пропускания и качество обслуживания (QoS). Благодаря использованию полнодуплексного Ethernet возможность коллизий при передаче исключается. Сеть спроектирована таким образом, что всему критическому трафику присваивается приоритет с использованием политик QoS, поэтому доставка, задержка и джиттер гарантированно находятся в пределах установленных параметров. Высокоинтеллектуальный коммутатор, общий для сети AFDX, может буферизовать пакеты передачи и приема. Благодаря использованию витой пары или оптоволоконных кабелей полнодуплексный Ethernet использует две отдельные пары или жилы для передачи и приема данных. AFDX расширяет стандарт Ethernet для обеспечения высокой целостности данных и детерминированной синхронизации. Кроме того, для улучшения целостности системы используется избыточная пара сетей (хотя виртуальный канал может быть настроен для использования только одной или другой сети). Он определяет совместимые функциональные элементы на следующих уровнях эталонной модели OSI :

Канал передачи данных (концепция адресации MAC и виртуального канала);
Сеть (IP и ICMP);
Транспорт (UDP и опционально TCP)
Приложение (сеть) (выборка, организация очереди, SAP, TFTP и SNMP).Основными элементами сети AFDX являются:

Конечные системы AFDX
Переключатели AFDX
Каналы AFDX

Виртуальные каналы
Центральным элементом сети AFDX являются виртуальные каналы (VL). В одной абстракции можно визуализировать VL как сеть в стиле ARINC 429, каждая из которых имеет один источник и одно или несколько пунктов назначения. Виртуальные каналы — это однонаправленные логические пути от исходной конечной системы ко всем конечным системам назначения. В отличие от традиционного коммутатора Ethernet, который переключает кадры на основе назначения Ethernet или MAC-адреса, AFDX маршрутизирует пакеты с использованием идентификатора виртуального канала, который переносится в той же позиции в кадре AFDX, что и MAC-адрес назначения в кадре Ethernet. Однако в случае AFDX этот идентификатор виртуального канала идентифицирует передаваемые данные, а не физический пункт назначения. Идентификатор виртуальной ссылки — это 16-битовое целое число без знака, которое следует за постоянным 32-битным полем. Коммутаторы предназначены для маршрутизации входящего кадра от одной и только одной конечной системы к заранее определённому набору конечных систем. В каждом виртуальном канале может быть одна или несколько принимающих конечных систем. Каждому виртуальному каналу выделяется определённая полоса пропускания [сумма всех интервалов между фреймами (bandwidth allocation gap, BAG) всех виртуальных каналов x MTU ] с общим объёмом полосы пропускания, определяемым системным интегратором. Однако общая пропускная способность не может превышать максимально доступную пропускную способность в сети. Следовательно, для двунаправленной связи требуется спецификация парного виртуального канала.
Каждый виртуальный канал заморожен в спецификации, чтобы гарантировать, что сеть имеет рассчитанный максимальный трафик, следовательно, детерминизм. Кроме того, коммутатор, имеющий загруженную таблицу конфигурации виртуальных каналов, может отклонить любую ошибочную передачу данных, которая в противном случае может затопить другие ветви сети. Кроме того, могут существовать субвиртуальные каналы (суб-VL), которые предназначены для передачи менее важных данных. Субвиртуальные каналы назначаются конкретному виртуальному каналу. Данные считываются в циклической последовательности среди виртуальных каналов с данными для передачи. Кроме того, субвиртуальные каналы не обеспечивают гарантированной пропускной способности или задержки из-за буферизации, но AFDX указывает, что задержка в любом случае измеряется функцией регулятора трафика.

BAG
BAG, bandwidth allocation gap, означает минимальный интервал времени между начальными битами двух последовательных кадров AFDX, это одна из основных особенностей протокола AFDX. Это максимальная скорость передачи данных, и она гарантированно отправляется через этот интервал. При установке скорости BAG для каждого виртуального канала необходимо позаботиться о том, чтобы пропускной способности было достаточно для других виртуальных каналов, а общая скорость не могла превышать 100 Мбит / с.

Переключатели виртуальных каналов
Каждый коммутатор имеет функции фильтрации, контроля и пересылки, которые должны быть способны обрабатывать не менее 4096 виртуальных каналов. Следовательно, в сети с несколькими коммутаторами (каскадной топологии типа «звезда») общее количество виртуальных каналов практически безгранично. Нет никакого определённого ограничения на количество виртуальных каналов, которые могут обрабатываться каждой конечной системой, хотя это будет определяться скоростью BAG и максимальным размером кадра, указанным для каждого виртуального канала, в сравнении со скоростью передачи данных Ethernet. Однако количество виртуальных суб-каналов, которые могут быть созданы в одном виртуальном канале, ограничено четырьмя. Коммутатор также должен быть неблокирующим на скоростях передачи данных, указанных системным интегратором, и на практике это может означать, что коммутатор должен иметь коммутационную способность, которая является суммой всех его физических портов.
Поскольку AFDX использует протокол Ethernet на уровне MAC, можно использовать высокопроизводительные коммутаторы COTS с маршрутизацией уровня 2 в качестве коммутаторов AFDX для целей тестирования в качестве меры по сокращению затрат. Однако некоторые функции настоящего коммутатора AFDX могут отсутствовать, например функции контроля трафика и резервирования.

Применение
Шина AFDX используется в Airbus A380, Boeing 787, Airbus A400M, Airbus A350, Sukhoi Superjet 100, ATR 42, ATR 72(-600), AgustaWestland AW101, AgustaWestland AW189, AgustaWestland AW169, МС-21, Bombardier Global Express Bombardier CSeries, Learjet 85, Comac ARJ21, и AgustaWestland AW149 .

Примечания
Ссылки
AFDX / ARINC664P7 Решения AIM Avionics для баз данных, интерфейсные платы для AFDX / ARINC-664
PBA.pro-AFDX Решения для баз данных AIM Avionics, анализаторы для AFDX / ARINC-664 и более
Обучение AFDX AIM Avionics Решения для шины данных, интерфейсные платы для AFDX / ARINC-664Учебное пособие по ARINC-664, часть 7 (AFDX) (видео) от Excalibur Systems Inc.
Embvue AFDX | Arinc 664 от Embvue
Учебное пособие по AFDX / ARINC 664 от GE Intelligent Platforms
AFDX Suite — AFDX Tools — программное решение для простого анализа и моделирования систем AFDX (EC Comp GmbH)
Avionics Ethernet Data Xplorer ARINC-664P7 Simulyzer — Программное обеспечение для мониторинга, моделирования и тестирования систем ARINC-664P7 / AFDX (MHZ Solutions)
Структура фрейма данных SID AFDX (MHZ Solutions)